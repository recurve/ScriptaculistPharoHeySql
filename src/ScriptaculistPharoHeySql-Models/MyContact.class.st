Class {
	#name : #MyContact,
	#superclass : #MyBaseRecord,
	#instVars : [
		'addressBookId',
		'addressBook',
		'firstName',
		'surname',
		'dateOfBirth',
		'telephoneNumber',
		'emailAddress',
		'photo',
		'photoMimeType'
	],
	#category : #'ScriptaculistPharoHeySql-Models'
}

{ #category : #accessor }
MyContact class >> deleteForId: p1 [ 
	     "Autogenerated heysql-method"
	     | result |
	     result := self executePreparedStatementSafe: 'deleteForId_MyContact' values: { p1 }.
	     ^ (self toObject: result).
	    
]

{ #category : #accessor }
MyContact class >> forAddressBook: addressBook [ 
	^ self forAddressBookId: addressBook id. 
	    
]

{ #category : #accessor }
MyContact class >> forAddressBookId: p1 [ 
	     "Autogenerated heysql-method"
	     | result |
	     result := self executePreparedStatementSafe: 'forAddressBookId_MyContact' values: { p1 }.
	     ^ (self toObject: result).
	    
]

{ #category : #accessor }
MyContact class >> forId: p1 [ 
	     "Autogenerated heysql-method"
	     | result |
	     result := self executePreparedStatementSafe: 'forId_MyContact' values: { p1 }.
	     ^ (self toObject: result).
	    
]

{ #category : #accessor }
MyContact class >> newForAddressBook: addressBook [
	| newAddressBook | 
	newAddressBook := self new.
	newAddressBook addressBook: addressBook.
	^newAddressBook. 
	    
]

{ #category : #utility }
MyContact class >> setupDatabaseFields [ 
self dbFields: 'addressBookId firstName surname dateOfBirth telephoneNumber emailAddress photo photoMimeType'. 
]

{ #category : #utility }
MyContact class >> setupMethodGeneration [
| dict |
dict := Dictionary
		newFrom:
			{
				('forAddressBookId' -> 'select * from mycontact where addressbookid = $1 order by surname asc, firstName asc') . 
				('forId' -> 'select * from mycontact where id = $1') . 
				('deleteForId' -> 'delete from mycontact where id = $1')
			}.
	self generateSqlMethods: dict.
]

{ #category : #accessing }
MyContact >> addressBook [
	^ addressBook
]

{ #category : #accessing }
MyContact >> addressBook: anObject [
	addressBook := anObject.
	addressBookId := anObject id. 
]

{ #category : #accessing }
MyContact >> addressBookId [
	^ addressBookId
]

{ #category : #accessing }
MyContact >> addressBookId: anObject [
	addressBookId := anObject
]

{ #category : #accessing }
MyContact >> dateOfBirth [
	^ dateOfBirth ifNil: [ dateOfBirth := Date today ]. 
]

{ #category : #accessing }
MyContact >> dateOfBirth: anObject [
	dateOfBirth := anObject
]

{ #category : #accessing }
MyContact >> delete [
	self isNotDeleted & self isPersisted
		ifTrue: [ self class deleteForId: self id.
			self isDeleted: true ].
	^ self
]

{ #category : #accessing }
MyContact >> emailAddress [
	^ emailAddress
]

{ #category : #accessing }
MyContact >> emailAddress: anObject [
	emailAddress := anObject
]

{ #category : #accessing }
MyContact >> firstName [
	^ firstName
]

{ #category : #accessing }
MyContact >> firstName: anObject [
	firstName := anObject
]

{ #category : #utility }
MyContact >> freshFromDB [
| freshContact |
id ifNil: [ freshContact := self class new ] 
	ifNotNil: [ freshContact := self class forId: id ].
self resetFromMemento: freshContact. 
^freshContact. 
]

{ #category : #accessing }
MyContact >> fullName [ 
| fullName |
firstName ifNil: [ fullName := surname ] ifNotNil: [ fullName := firstName, ' ', surname ].
fullName ifNil: [ fullName := 'Empty' ].
(fullName trim isEmpty) ifTrue: [ fullName := 'Empty' ].
^fullName. 
]

{ #category : #accessing }
MyContact >> identifier [ 
^self fullName asLowercase onlyLetters , id asString. 
]

{ #category : #accessing }
MyContact >> photo [
	^ photo
]

{ #category : #accessing }
MyContact >> photo: anObject [
	photo := anObject
]

{ #category : #accessing }
MyContact >> photoMimeType [
	^ photoMimeType
]

{ #category : #accessing }
MyContact >> photoMimeType: anObject [
	photoMimeType := anObject
]

{ #category : #utility }
MyContact >> resetFromMemento: aMemento [
dateOfBirth := aMemento dateOfBirth.
emailAddress := aMemento emailAddress.
firstName := aMemento firstName.
surname := aMemento surname.
telephoneNumber := aMemento telephoneNumber.
photo := aMemento photo. 
photoMimeType := aMemento photoMimeType. 
]

{ #category : #accessing }
MyContact >> surname [
	^ surname
]

{ #category : #accessing }
MyContact >> surname: anObject [
	surname := anObject
]

{ #category : #accessing }
MyContact >> telephoneNumber [
	^ telephoneNumber
]

{ #category : #accessing }
MyContact >> telephoneNumber: anObject [
	telephoneNumber := anObject
]
